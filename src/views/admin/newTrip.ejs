<% layout("./layouts/boilerplate.ejs") %>

    <style>
        #todoContainer {
            margin-top: 20px;
        }

        .todoItem {
            margin-bottom: 5px;
        }

        .deleteButton {
            margin-left: 5px;
        }
    </style>

    <form action="/" method="POST" enctype="multipart/form-data">
        <div class="input-container">
            <label for="departure" class="form-label mb-2">departure</label>
            <input required type="date" name="departure" id="departure" class="form-control tripDate"
                onchange="calculateDurationAndAddStops()">
        </div>

        <div class="input-container">
            <label for="endDate" class="form-label mb-2">end date</label>
            <input required type="date" name="endDate" id="endDate" class="form-control "
                onchange="calculateDurationAndAddStops()">
        </div>
        <button type="button" class="btn" id="addStopBtn" onclick="addStop()">Add Stop</button>

        <div class="input-container">
            <label for="location" class="form-label mb-2">Enter location</label>
            <input required type="text" name="location" id="location" class="form-control ">
        </div>


        <h2 class="catagaries-text">ADD CATAGARIES</h2>
        <div class="catagaries-container">
            <div>
                <label class="label-btns" for="one"><i class="fa-solid fa-utensils"></i> Foods</label>
                <input type="checkbox" class="input-btns" id="one" autocomplete="off" value="Foods" name="catagaries[]">
    
            </div>
            <div>
                <label class="label-btns" for="two"><i class="fa-solid fa-umbrella-beach"></i> Beach</label>
                <input type="checkbox" class="input-btns" id="two" autocomplete="off" value="Beach" name="catagaries[]">
    
            </div>
            <div>
                <label class="label-btns" for="three"><i class="fa-brands fa-fort-awesome"></i> Culture</label>
                <input type="checkbox" class="input-btns" id="three" autocomplete="off" value="Culture" name="catagaries[]">
    
    
            </div>
            <div>
                <label class="label-btns" for="four"><i class="fa-solid fa-champagne-glasses"></i> Party</label>
                <input type="checkbox" class="input-btns" id="four" autocomplete="off" value="Party" name="catagaries[]">
    
            </div>
            <div>
                <label class="label-btns" for="five"><i class="fa-solid fa-volleyball"></i> Sports</label>
                <input type="checkbox" class="input-btns" id="five" autocomplete="off" value="Sports" name="catagaries[]">
    
            </div>
            <div>
                <label class="label-btns" for="six"><i class="fa-solid fa-mountain-sun"></i> Nature</label>
                <input type="checkbox" class="input-btns" id="six" autocomplete="off" value="Nature" name="catagaries[]">    
            </div>




        </div>

        <div class="mt-3 input-container">
            <label  for="title" class="form-label mb-2">Trip title</label>
            <input required type="text" name="title" id="title" class="form-control ">
        </div>

        <div class="textarea-container mt-3">
            <span class="input-group-text">Trip description</span>
            <textarea requiredclass="form-control input-container-textarea"  name="tripDescription" aria-label="With textarea"
                placeholder="Write an overview of the trip giving a unique selling point.."></textarea>
        </div>
        <div class="input-group mt-3 textarea-container">
            <span class="input-group-text">About you</span>
            <textarea class="form-control input-container-textarea" name="aboutLeader" aria-label="With textarea"
                placeholder="Introduce yourself and your expectations of the trip.."></textarea>
        </div>
        <h2 class="catagaries-text">ACCOMODATIONS</h2>
        <div class="accomodations mt-3">
            <label class="form-check-label" for="1">
                Hotels
            </label>
            <input class="acc-input" type="checkbox" value="Hotel" id="1" name="accomodations[]">

            <label class="form-check-label" for="2">
                Hostels
            </label>
            <input class="form-check-input acc-input" type="checkbox" value="Hostels" id="2" name="accomodations[]">

            <label class="form-check-label" for="3">
                Apartments
            </label>
            <input class="form-check-input acc-input" type="checkbox" value="Apartments" id="3" name="accomodations[]">

            <label class="form-check-label" for="4">
                Camping
            </label>
            <input class="form-check-input acc-input" type="checkbox" value="Camping" id="4" name="accomodations[]">

            <label class="form-check-label" for="5">
                Bed & Breakfast
            </label>
            <input class="form-check-input acc-input" type="checkbox" value="Bed & Breakfast" id="5" name="accomodations[]">
        </div>

        <div class="includes-container mt-3 mb-3">
            <input type="text" class="form-control" id="todoInput" placeholder="Enter includes"
                aria-label="Example text with button addon" aria-describedby="button-addon1">
            <button onclick="addTodo()" class="btn" type="button" id="button-addon1">Add</button>
        </div>

        <div id="todoContainer">
            <!-- Todos will be added here -->
        </div>


        <div class="mt-3 input-container">
            <label for="tripImages[]" class="form-label mb-2">Trip images</label>
            <input type="file" name="tripImages[]" id="tripImages[]" class="form-control" multiple>
        </div>

        <div id="stops-container">
            <!-- Initial stop section -->
            <div class="stop-section">
                <h3>Stop 1</h3>

                <label for="stopImages" class="form-label mb-2">Upload Image</label>
                <input type="file" name="stopImages[]" class="form-control" multiple>

                <label for="stopLocation" class="form-label mb-2">Enter Location</label>
                <input required type="text" name="stopLocation[]" class="form-control">

                <label for="stopDescription" class="form-label mb-2">Tell Us More</label>
                <input required type="text" name="stopDescription[]" class="form-control">
            </div>
        </div>

        <button type="button" class="btn" onclick="addStop()">Add Stop</button>

        <button class="submit-btn">SUBMIT</button>
    </form>

    <script>
        function addTodo() {
            // Get the value from the input field
            var todoValue = document.getElementById('todoInput').value;

            // Create a container div for the todo item
            var todoContainer = document.createElement('div');
            todoContainer.className = 'todoItem';

            // Create a new input element for the todo
            var newTodoInput = document.createElement('input');
            newTodoInput.type = 'text';
            newTodoInput.value = todoValue;
            newTodoInput.name = 'includes[]';

            // Create a delete button
            var deleteButton = document.createElement('button');
            deleteButton.className = 'deleteButton';
            deleteButton.className = 'btn';
            deleteButton.innerHTML = 'Delete';
            deleteButton.onclick = function () {
                // Remove the todo item when the delete button is clicked
                todoContainer.remove();
            };

            // Append the new input and delete button to the todoContainer div
            todoContainer.appendChild(newTodoInput);
            todoContainer.appendChild(deleteButton);

            // Append the todoContainer to the todoContainer div
            document.getElementById('todoContainer').appendChild(todoContainer);

            // Clear the input field for the next todo
            document.getElementById('todoInput').value = '';
        }

        let stopCounter = 1;

        function addStop() {
            stopCounter++;

            const stopsContainer = document.getElementById('stops-container');

            const newStopSection = document.createElement('div');
            newStopSection.className = 'stop-section';

            newStopSection.innerHTML = `
                <h3>Stop ${stopCounter}</h3>
    
                <label for="stopImages" class="form-label mb-2">Upload Image</label>
                <input type="file" name="stopImages[]" class="form-control">
    
                <label for="stopLocation" class="form-label mb-2">Enter Location</label>
                <input type="text" name="stopLocation[]" class="form-control">
    
                <label for="stopDescription" class="form-label mb-2">Tell Us More</label>
                <input type="text" name="stopDescription[]" class="form-control">
    
                <button type="button" class="btn" onclick="deleteStop(this)">Delete Stop</button>
            `;

            stopsContainer.appendChild(newStopSection);
            updateStopNumbers();
        }

        function deleteStop(button) {
            const stopsContainer = document.getElementById('stops-container');
            const stopSection = button.parentNode;
            stopsContainer.removeChild(stopSection);
            stopCounter--;
            updateStopNumbers();
        }

        function updateStopNumbers() {
            const stops = document.getElementsByClassName('stop-section');
            Array.from(stops).forEach((stop, index) => {
                const stopNumber = index + 1;
                stop.querySelector('h3').innerText = `Stop ${stopNumber}`;
            });
        }

        function calculateDurationAndAddStops() {
            // Get the departure and end date values
            const departureDate = new Date(document.getElementById('departure').value);
            const endDate = new Date(document.getElementById('endDate').value);

            // Calculate the duration in days
            const durationInDays = Math.floor((endDate - departureDate) / (24 * 60 * 60 * 1000));

            // Call a function to dynamically add stops based on the calculated duration
            addStopsBasedOnDuration(durationInDays);
        }

        function addStopsBasedOnDuration(duration) {
            // Clear existing stops
            const stopsContainer = document.getElementById('stops-container');
            stopsContainer.innerHTML = '';

            // Add stops dynamically based on the duration
            for (let i = 1; i <= duration; i++) {
                const newStopSection = document.createElement('div');
                newStopSection.className = 'stop-section';

                newStopSection.innerHTML = `
                    <h3>Stop ${i}</h3>
    
                    <label for="stopImages" class="form-label mb-2">Upload Image</label>
                    <input type="file" name="stopImages[]" class="form-control">
    
                    <label for="stopLocation" class="form-label mb-2">Enter Location</label>
                    <input type="text" name="stopLocation[]" class="form-control">
    
                    <label for="stopDescription" class="form-label mb-2">Tell Us More</label>
                    <input type="text" name="stopDescription[]" class="form-control">
    
                    <button type="button" onclick="deleteStop(this)">Delete Stop</button>
                `;

                stopsContainer.appendChild(newStopSection);
            }
        }
    </script>