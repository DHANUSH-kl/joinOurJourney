<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
        <link rel="stylesheet" href="/css/nav.css">
    <link rel="stylesheet" href="/css/style.css">
    <title>Document</title>
</head>

<body>

    <nav>
        <div class="logo">
            <h3>LOGO</h3>
        </div>
        <div class="trips-nav">
            <a href="/">ALL TRIPS</a>
        </div>
        <div class="user-nav">
            <% if(!currUser){ %>
                <a href="/user/signup">SIGN UP</a>
                <a href="/user/signin">SIGN IN</a>
            <% } %>

            <% if(currUser){ %>
                <a href="/user/logout">LOG OUT</a>
            <% } %>
            <div class="user" id="user">
                <i class="fa-regular fa-user"></i>
            </div>
        </div>

        <div class="dropdown-container" id="dropdown">
            <div class="close">
                <i class="fa-solid fa-xmark" id="close"></i>
            </div>
            <div class="user-info-container">
                <% if(!currUser) { %>
                    <div class="profile"></div>
                    <p>USERNAME</p>    
                <% } else { %>
                    <div class="profile"></div>
                    <p><%= currUser.username %></p> 
                <% } %>
            </div>
            <div class="nav-links">
                <a href="/mytrips">MY TRIP</a>
                <a href="/createtrip">CREATE TRIP</a>
                <a href="/">PAYMENTS AND PAYOUTS</a>
                <a href="/user/signup">SIGN UP</a>    
            </div>
        </div>
    </nav>

    

    <div class="form-container">
        <form action="/createtrip" method="POST" enctype="multipart/form-data">
            <h1>CREATE YOUR TRIP</h1>
            <div class="location-container">
                <label for="location" class="form-label mb-2">Enter location</label>
                <input type="text" name="location" id="location" class="form-control ">
            </div>

            <div class="title-container">
                <label for="title" class="form-label mb-2">Trip title</label>
                <input type="text" name="title" id="title" class="form-control ">
            </div>

            <div class="description-container">
                <span class="input-group-text">Trip description</span>
                <textarea class="form-control input-container-textarea" name="tripDescription"
                    aria-label="With textarea"
                    placeholder="Write an overview of the trip giving a unique selling point.."></textarea>
            </div>

            <div class="tripmate-container">

                <div class="conatiner">
                    <label for="minTripmates" class="form-label mb-2">Mininmum tripmates</label>
                    <input min="1" type="number" name="minTripmates" id="minTripmates" class="form-control ">
                </div>

                <div class="conatiner">
                    <label for="maxTripmates" class="form-label mb-2">Maximum tripmates</label>
                    <input min="1" type="number" name="maxTripmates" id="maxTripmates" class="form-control ">
                </div>

            </div>

            <div class="images-container">
                <label for="tripImages[]" class="form-label mb-2">Trip images</label>
                <input type="file" name="tripImages[]" id="tripImages[]" class="form-control" multiple>
            </div>


            <h2 class="catagaries-text">SELECT CATAGARIES</h2>
            <div class="catagaries-container">
                <div>
                    <label class="label-btns" for="one"><i class="fa-solid fa-utensils"></i> Foods</label>
                    <input type="checkbox" class="input-btns" id="one" autocomplete="off" value="foods"
                        name="categories[]">

                </div>
                <div>
                    <label class="label-btns" for="two"><i class="fa-solid fa-umbrella-beach"></i> Beach</label>
                    <input type="checkbox" class="input-btns" id="two" autocomplete="off" value="beach"
                        name="categories[]">

                </div>
                <div>
                    <label class="label-btns" for="three"><i class="fa-brands fa-fort-awesome"></i> Culture</label>
                    <input type="checkbox" class="input-btns" id="three" autocomplete="off" value="culture"
                        name="categories[]">


                </div>
                <div>
                    <label class="label-btns" for="four"><i class="fa-solid fa-champagne-glasses"></i> Party</label>
                    <input type="checkbox" class="input-btns" id="four" autocomplete="off" value="party"
                        name="categories[]">

                </div>
                <div>
                    <label class="label-btns" for="five"><i class="fa-solid fa-volleyball"></i> Sports</label>
                    <input type="checkbox" class="input-btns" id="five" autocomplete="off" value="sports"
                        name="categories[]">

                </div>
                <div>
                    <label class="label-btns" for="six"><i class="fa-solid fa-mountain-sun"></i> Nature</label>
                    <input type="checkbox" class="input-btns" id="six" autocomplete="off" value="nature"
                        name="categories[]">
                </div>




            </div>


            <h2 class="catagaries-text">ACCOMODATIONS</h2>
            <div class="accomodations-container mt-3">
                <div>
                    <label for="1">
                        Hotels
                    </label>
                    <input type="checkbox" value="hotel" id="1" name="accomodations[]">
                </div>
                <div>
                    <label for="2">
                        Hostels
                    </label>
                    <input type="checkbox" value="hostels" id="2" name="accomodations[]">
                </div>
                <div>
                    <label for="3">
                        Apartments
                    </label>
                    <input class="form-check-input acc-input" type="checkbox" value="apartments" id="3"
                        name="accomodations[]">
                </div>
                <div>
                    <label class="form-check-label" for="4">
                        Camping
                    </label>
                    <input class="form-check-input acc-input" type="checkbox" value="camping" id="4"
                        name="accomodations[]">
                </div>
                <div>
                    <label class="form-check-label" for="5">
                        Bed & Breakfast
                    </label>
                    <input class="form-check-input acc-input" type="checkbox" value="bed & breakfast" id="5"
                        name="accomodations[]">
                </div>

            </div>

            <div class="includes-container">
                <input type="text" class="form-control" id="todoInput" placeholder="Enter includes"
                    aria-label="Example text with button addon" aria-describedby="button-addon1">
                <button onclick="addTodo()" class="btn" type="button" id="button-addon1">Add</button>
            </div>

            <div id="todoContainer">
                <!-- Todos will be added here -->
            </div>

            <div class="excludes-container">
                <input type="text" class="form-control" id="excludesInput" placeholder="Enter excludes"
                    aria-label="Example text with button addon" aria-describedby="button-addon1">
                <button onclick="excludes()" class="btn" type="button" id="excludesButton">Add</button>
            </div>
        
            <div id="excludes-todoContainer">
                <!-- Excludes will be added here -->
            </div>

            <div class="days-container">
                <label for="departure" class="form-label mb-2">departure</label>
                <input type="date" name="departure" id="departure" class="form-control tripDate"
                    onchange="calculateDurationAndAddStops()">
            </div>
            <div class="days-container">
                <label for="endDate" class="form-label mb-2">end date</label>
                <input type="date" name="endDate" id="endDate" class="form-control "
                    onchange="calculateDurationAndAddStops()">
            </div>
            <button type="button" class="btn" id="addStopBtn" onclick="addStop()">Add Stop</button>

            <div class="stop-container" id="stops-container">
                <!-- Initial stop section for Stop 1 -->
                <div class="stop-section">
                    <h3>Stop 1</h3>
                    <label for="stopImages" class="form-label mb-2">Upload Image</label>
                    <input type="file" name="stopImages[]" class="form-control">

                    <label for="stopLocation" class="form-label mb-2">Enter Location</label>
                    <input type="text" name="stopLocation[]" class="form-control">

                    <label for="stopDescription" class="form-label mb-2">Tell Us More</label>
                    <input type="text" name="stopDescription[]" class="form-control">

                </div>
            </div>
            <button type="button" class="btn add-stop" onclick="addStop()">Add Stop</button>

            <div class="trip-calculator-conatiner">

                <h2>Cost per tripmate</h2>


                <div class="travel-cost-container">

                    <h2>Travel cost</h2>
                    <div class="train-ticket">
                        <label for="trainTicket" class="form-label mb-2">Train ticket cost : ₹</label>
                        <input type="number" name="trainTicket" class="form-control">
                    </div>

                    <div class="flight-ticket">
                        <label for="flightTicket" class="form-label mb-2">Flight ticket cost : ₹</label>
                        <input type="number" name="flightTicket" class="form-control">
                    </div>

                    <h2>Total trip cost</h2>

                    <div class="total-cost">
                        <label for="totalCost" class="form-label mb-2">Total trip cost : ₹</label>
                        <input type="number" name="totalCost" class="form-control">
                    </div>

                    <h2>Trip buffer</h2>
                    <div class="total-cost">
                        <label for="buffer" class="form-label mb-2">Enter the buffer : %</label>
                        <input type="number" name="buffer" min="0" max="15" class="form-control">
                    </div>

                </div>

            </div>

            <button class="submit-btn">SUBMIT</button>
        </form>
    </div>


    <script>
        function addTodo() {
            // Get the value from the input field
            var todoValue = document.getElementById('todoInput').value;

            // Create a container div for the todo item
            var todoContainer = document.createElement('div');
            todoContainer.className = 'todoItem';

            // Create a new input element for the todo
            var newTodoInput = document.createElement('input');
            newTodoInput.type = 'text';
            newTodoInput.value = todoValue;
            newTodoInput.name = 'includes[]';

            // Create a delete button
            var deleteButton = document.createElement('button');
            deleteButton.className = 'deleteButton';
            deleteButton.className = 'btn';
            deleteButton.innerHTML = 'Delete';
            deleteButton.onclick = function () {
                // Remove the todo item when the delete button is clicked
                todoContainer.remove();
            };

            // Append the new input and delete button to the todoContainer div
            todoContainer.appendChild(newTodoInput);
            todoContainer.appendChild(deleteButton);

            // Append the todoContainer to the todoContainer div
            document.getElementById('todoContainer').appendChild(todoContainer);

            // Clear the input field for the next todo
            document.getElementById('todoInput').value = '';
        }

        function excludes() {
            // Get the value from the input field
            var excludeValue = document.getElementById('excludesInput').value;

            // Create a container div for the exclude item
            var excludesContainer = document.createElement('div');
            excludesContainer.className = 'excludeItem';

            // Create a new input element for the exclude
            var newExcludeInput = document.createElement('input');
            newExcludeInput.type = 'text';
            newExcludeInput.value = excludeValue;
            newExcludeInput.name = 'excludes[]';

            // Create a delete button
            var deleteButton = document.createElement('button');
            deleteButton.className = 'deleteButton';
            deleteButton.className = 'btn';
            deleteButton.innerHTML = 'Delete';
            deleteButton.onclick = function () {
                // Remove the exclude item when the delete button is clicked
                excludesContainer.remove();
            };

            // Append the new input and delete button to the excludesContainer div
            excludesContainer.appendChild(newExcludeInput);
            excludesContainer.appendChild(deleteButton);

            // Append the excludesContainer to the excludesContainer div
            document.getElementById('excludes-todoContainer').appendChild(excludesContainer);

            // Clear the input field for the next exclude
            document.getElementById('excludesInput').value = '';
        }

        let stopCounter = 1;

        function addStop() {
            stopCounter++;

            const stopsContainer = document.getElementById('stops-container');

            const newStopSection = document.createElement('div');
            newStopSection.className = 'stop-section';

            newStopSection.innerHTML = `
                <h3>Stop ${stopCounter}</h3>
    
                <label for="stopImages" class="form-label mb-2">Upload Image</label>
                <input type="file" name="stopImages[]" class="form-control">
    
                <label for="stopLocation" class="form-label mb-2">Enter Location</label>
                <input type="text" name="stopLocation[]" class="form-control">
    
                <label for="stopDescription" class="form-label mb-2">Tell Us More</label>
                <input type="text" name="stopDescription[]" class="form-control">
    
                <button type="button" class="btn" onclick="deleteStop(this)">Delete Stop</button>
            `;

            stopsContainer.appendChild(newStopSection);
            updateStopNumbers();
        }

        function deleteStop(button) {
            const stopsContainer = document.getElementById('stops-container');
            const stopSection = button.parentNode;
            stopsContainer.removeChild(stopSection);
            stopCounter--;
            updateStopNumbers();
        }

        function updateStopNumbers() {
            const stops = document.getElementsByClassName('stop-section');
            Array.from(stops).forEach((stop, index) => {
                const stopNumber = index + 1;
                stop.querySelector('h3').innerText = `Stop ${stopNumber}`;
            });
        }

        function calculateDurationAndAddStops() {
            // Get the departure and end date values
            const departureDate = new Date(document.getElementById('departure').value);
            const endDate = new Date(document.getElementById('endDate').value);

            // Calculate the duration in days
            const durationInDays = Math.floor((endDate - departureDate) / (24 * 60 * 60 * 1000));

            // Call a function to dynamically add stops based on the calculated duration
            addStopsBasedOnDuration(durationInDays);
        }

        function addStopsBasedOnDuration(duration) {
    const stopsContainer = document.getElementById('stops-container');
    // Clear existing stops
    stopsContainer.innerHTML = '';

    // Always keep Stop 1
    const initialStopSection = document.createElement('div');
    initialStopSection.className = 'stop-section';
    initialStopSection.innerHTML = `
        <h3>Stop 1</h3>
        <label for="stopImages" class="form-label mb-2">Upload Image</label>
        <input type="file" name="stopImages[]" class="form-control">
        <label for="stopLocation" class="form-label mb-2">Enter Location</label>
        <input type="text" name="stopLocation[]" class="form-control">
        <label for="stopDescription" class="form-label mb-2">Tell Us More</label>
        <input type="text" name="stopDescription[]" class="form-control">
    `;
    stopsContainer.appendChild(initialStopSection);

    // Add stops dynamically based on the duration, including the departure date
    for (let i = 2; i <= duration + 1; i++) {
        const newStopSection = document.createElement('div');
        newStopSection.className = 'stop-section';
        newStopSection.innerHTML = `
            <h3>Stop ${i}</h3>
            <label for="stopImages" class="form-label mb-2">Upload Image</label>
            <input type="file" name="stopImages[]" class="form-control">
            <label for="stopLocation" class="form-label mb-2">Enter Location</label>
            <input type="text" name="stopLocation[]" class="form-control">
            <label for="stopDescription" class="form-label mb-2">Tell Us More</label>
            <input type="text" name="stopDescription[]" class="form-control">
            <button type="button" class="btn" onclick="deleteStop(this)">Delete Stop</button>
        `;
        stopsContainer.appendChild(newStopSection);
    }
    updateStopNumbers();
}
    </script>

<script src="/js/nav.js"></script>

</body>

</html>