<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
      <!-- Link Swiper's CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />


    <link rel="stylesheet" href="/css/nav.css">
    <title>Document</title>
</head>
<body>
    
    <nav>
        <div class="logo">
            <h3>LOGO</h3>
        </div>
        <div class="trips-nav">
            <a href="/">ALL TRIPS</a>
        </div>
        <div class="user-nav">
            <% if(!currUser){ %>
                <a href="/user/signup">SIGN UP</a>
                <a href="/user/signin">SIGN IN</a>
            <% } %>

            <% if(currUser){ %>
                <a href="/user/logout">LOG OUT</a>
            <% } %>
            <div class="user" id="user">
                <i class="fa-regular fa-user"></i>
            </div>
        </div>

        <div class="dropdown-container" id="dropdown">
            <div class="close">
                <i class="fa-solid fa-xmark" id="close"></i>
            </div>
            <div class="user-info-container">
                <% if(!currUser) { %>
                    <div class="profile"></div>
                    <p>USERNAME</p>    
                <% } else { %>
                    <div class="profile"></div>
                    <p><%= currUser.username %></p> 
                <% } %>
            </div>
            <div class="nav-links">
                <a href="/mytrips">MY TRIP</a>
                <a href="/createtrip">CREATE TRIP</a>
                <a href="/">PAYMENTS AND PAYOUTS</a>
                <a href="/user/signup">SIGN UP</a>    
            </div>
        </div>
    </nav>

    <!-- Swiper -->
  <div class="swiper mySwiper">
    <div class="swiper-wrapper">
        <% if (trip.tripImages) { %>
            <% trip.tripImages.forEach(function(image, index) { %>
                <div class="swiper-slide">
                    <img src="<%= image.path %>" alt="Image <%= index + 1 %>">
                </div>
            <% }); %>
        <% } else { %>
            <div class="swiper-slide">
                <img alt="No Image">
            </div>
        <% } %>
    </div>
    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>
    <div class="swiper-pagination"></div>
  </div>



    <h1> <%= trip.title %> </h1>
    <h3> <%= trip.tripDescription %> </h3>
    <h3> <%= trip.departure %> </h3>
    <h3> <%= trip.includes %> </h3>
    
    <h1>Stops</h1>
    
    <h1><%= trip.stopLocation %></h1>
    <h1><%= trip.stopDescription %></h1>
    <h1><%= trip.owner.username %></h1>

    <% if (trip.stopImages && trip.stopImages.length > 0) { %>
        <div id="existingStopImages">
            <% trip.stopImages.forEach(function(image, index) { %>
                <div class="existing-image">
                    <img src="<%= image.path %>" alt="Stop Image <%= index + 1 %>">
                </div>
            <% }); %>
        </div>
    <% } else { %>
        <img alt="No Image">
    <% } %>    

    
    
    
    <% if ( currUser && currUser._id.toString() == trip.owner._id.toString() ) { %>
        <form action="/<%= trip._id %>/?_method=DELETE" method="POST">
            <button>Delete</button>
        </form>
    <% } %>
    
    
    <% if ( currUser && currUser._id.toString() == trip.owner._id.toString() ) { %>
        <form action="/<%= trip._id %>/editTrip" method="GET">
            <button>Edit</button>
        </form>
    <% } %>
    
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

     <!-- Initialize Swiper -->
  <script>
    var swiper = new Swiper(".mySwiper", {
      slidesPerView: 1,
      spaceBetween: 30,
      loop: true,
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
    });
  </script>

    <script src="/js/nav.js"></script>



</body>
</html>
